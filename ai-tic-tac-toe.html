<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Tic Tac Toe AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#f2f4ff;
  --card:#ffffff;
  --text:#222;
  --accent:#6c63ff;
  --cell:#ffffff;
  --grid:#b8b8ff;
}

body.dark{
  --bg:#0f1220;
  --card:#1c1f3a;
  --text:#eee;
  --cell:#2a2d4a;
  --grid:#6c63ff;
}

body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  background:var(--bg);
  color:var(--text);
  font-family:Arial, sans-serif;
  transition:.4s;
}

.container{
  background:var(--card);
  padding:25px;
  width:360px;
  border-radius:20px;
  display:flex;
  flex-direction:column;
  gap:15px;
  box-shadow:0 25px 50px rgba(0,0,0,.25);
}

header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

h1{margin:0;color:var(--accent);}

button,select{
  padding:10px;
  border-radius:10px;
  border:none;
  cursor:pointer;
  background:var(--accent);
  color:white;
}

select{background:#eee;color:#000;}

body.dark select{background:#2a2d4a;color:#fff;}

.scoreboard{
  display:flex;
  justify-content:space-around;
  font-weight:bold;
}

.status{
  text-align:center;
  min-height:22px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:8px;
  background:var(--grid);
  padding:8px;
  border-radius:15px;
}

.cell{
  aspect-ratio:1;
  background:var(--cell);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:2.3rem;
  border-radius:12px;
  cursor:pointer;
  transition:.2s;
}

.cell:hover{opacity:.85}

.win{
  animation:glow .8s infinite alternate;
}

@keyframes glow{
  from{box-shadow:0 0 5px #2ecc71}
  to{box-shadow:0 0 20px #2ecc71}
}
</style>
</head>

<body>
<div class="container">
<header>
  <h1>Tic Tac Toe</h1>
  <button id="darkToggle">üåô</button>
</header>

<select id="difficulty">
  <option value="easy">Easy</option>
  <option value="medium">Medium</option>
  <option value="hard">Hard</option>
</select>

<div class="scoreboard">
  <div>You: <span id="pScore">0</span></div>
  <div>Draw: <span id="dScore">0</span></div>
  <div>AI: <span id="aScore">0</span></div>
</div>

<div class="status" id="status">Your turn (X)</div>

<div class="grid" id="grid"></div>

<button id="reset">Reset</button>
</div>

<script>
const grid=document.getElementById("grid");
const statusText=document.getElementById("status");
const pScore=document.getElementById("pScore");
const aScore=document.getElementById("aScore");
const dScore=document.getElementById("dScore");
const difficulty=document.getElementById("difficulty");

let board=Array(9).fill("");
let gameOver=false;
let scores={p:0,a:0,d:0};

// Sounds (FIXED)
const clickSound=new Audio("click.mp3");
const winSound=new Audio("win.mp3");
const drawSound=new Audio("draw.mp3");

let unlocked=false;
document.body.addEventListener("click",()=>{
  if(unlocked) return;
  clickSound.play().then(()=>{clickSound.pause();clickSound.currentTime=0;unlocked=true});
},{once:true});

const play=s=>unlocked&&s.play().catch(()=>{});

// Crash talk
const taunts=[
 "Too easy üòè","You sure about that?","I saw that coming ü§ñ",
 "Blocked!","Try harder üòà"
];

const wins=[
 [0,1,2],[3,4,5],[6,7,8],
 [0,3,6],[1,4,7],[2,5,8],
 [0,4,8],[2,4,6]
];

// Create cells
for(let i=0;i<9;i++){
  const c=document.createElement("div");
  c.className="cell";
  c.onclick=()=>playerMove(i,c);
  grid.appendChild(c);
}

function playerMove(i,cell){
  if(board[i]||gameOver) return;
  board[i]="X"; cell.textContent="X";
  play(clickSound);
  if(checkEnd("X")) return;
  aiMove();
}

function aiMove(){
  let i=difficulty.value==="hard"
    ? minimax(board,"O").i
    : random();
  board[i]="O";
  grid.children[i].textContent="O";
  play(clickSound);
  statusText.textContent=taunts[Math.floor(Math.random()*taunts.length)];
  checkEnd("O");
}

function checkEnd(p){
  for(let w of wins){
    if(w.every(i=>board[i]===p)){
      w.forEach(i=>grid.children[i].classList.add("win"));
      gameOver=true;
      p==="X"?scores.p++:scores.a++;
      play(winSound);
      updateScores();
      statusText.textContent=p==="X"?"You win üéâ":"AI wins üòà";
      return true;
    }
  }
  if(!board.includes("")){
    gameOver=true;
    scores.d++;
    play(drawSound);
    updateScores();
    statusText.textContent="It's a draw üòê";
    return true;
  }
  return false;
}

function updateScores(){
  pScore.textContent=scores.p;
  aScore.textContent=scores.a;
  dScore.textContent=scores.d;
}

function random(){
  return board.map((v,i)=>v==""?i:null).filter(v=>v!==null)[Math.floor(Math.random()*9)];
}

// Hard AI
function minimax(b,p){
  if(win(b,"X")) return{score:-10};
  if(win(b,"O")) return{score:10};
  if(!b.includes("")) return{score:0};

  let best={score:p==="O"?-Infinity:Infinity};
  b.forEach((v,i)=>{
    if(v===""){
      b[i]=p;
      let s=minimax(b,p==="O"?"X":"O").score;
      b[i]="";
      if(p==="O"&&s>best.score||p==="X"&&s<best.score)
        best={score:s,i};
    }
  });
  return best;
}

function win(b,p){return wins.some(w=>w.every(i=>b[i]===p));}

document.getElementById("reset").onclick=()=>{
  board.fill("");
  [...grid.children].forEach(c=>{c.textContent="";c.classList.remove("win")});
  gameOver=false;
  statusText.textContent="Your turn (X)";
};

document.getElementById("darkToggle").onclick=()=>{
  document.body.classList.toggle("dark");
};
</script>
</body>
</html>
